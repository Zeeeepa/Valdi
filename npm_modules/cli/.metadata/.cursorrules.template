# Valdi Open Source - Cursor Rules

## ‚ö†Ô∏è Open Source Project

This is an open source project. Never commit secrets, API keys, or proprietary information.

## üö® CRITICAL: This is NOT React!

Valdi uses TSX/JSX syntax but is **fundamentally different from React**. 

**Common AI mistakes:**
- ‚ùå Suggesting `useState`, `useEffect`, `useContext` (don't exist!)
- ‚ùå Functional components (don't exist!)
- ‚ùå `this.props` (should be `this.viewModel`)
- ‚ùå `markNeedsRender()`, `onMount()`, `onUpdate()` (wrong names/don't exist!)

**Correct Valdi:**
- ‚úÖ `class MyComponent extends StatefulComponent`
- ‚úÖ `state = {}` + `this.setState()`
- ‚úÖ `this.viewModel` for props
- ‚úÖ `onCreate()`, `onViewModelUpdate()`, `onDestroy()` lifecycle

## üìÅ Context-Specific Rules

Cursor automatically loads additional rules based on where you're working:

| Working In | See |
|-----------|-----|
| TypeScript/TSX components | `.cursor/rules/typescript-tsx.md` |
| Swift compiler | `.cursor/rules/compiler.md` |
| C++ runtime | `.cursor/rules/cpp-runtime.md` |
| Android (Kotlin) | `.cursor/rules/android.md` |
| iOS (Objective-C) | `.cursor/rules/ios.md` |
| Bazel files | `.cursor/rules/bazel.md` |
| Tests | `.cursor/rules/testing.md` |

**‚Üí Check `.cursor/rules/README.md` for the full list**

## Quick Commands

```bash
bazel build //...          # Build everything
bazel test //...           # Run all tests
valdi install ios          # Build & install iOS app
valdi hotreload            # Start hot reload
```

## Exported library / host apps

When integrating an exported AAR or xcframework into a host app:

- **Android:** Generated view classes use package **`com.snap.modules.<module_name>`** (e.g. `com.snap.modules.test_test.App`), not `com.snap.valdi.modules`. `System.loadLibrary(...)` must use the exact `valdi_exported_library()` target name (e.g. `test_test_export`).
- **iOS:** Root view class is **`<module_name><RootComponentName>`** where `module_name` is the Valdi **module name** from `valdi_module()` (snake_case, e.g. `test_test` ‚Üí `test_testApp`), not `ios_bundle_name`. For export use **`--library test_test_export_ios`** (platform-suffixed target). Embed the xcframework into the app's **Frameworks** folder (Embed Frameworks phase ‚Üí destination **Frameworks**, not PlugIns), or the app crashes at launch with "Library not loaded: @rpath/...framework/...".

## More Information

- **Comprehensive guide**: `/AGENTS.md` (621 lines)
- **AI tooling**: `/docs/docs/ai-tooling.md`
- **Support**: `/SUPPORT.md`
- **Discord**: https://discord.gg/uJyNEeYX2U
